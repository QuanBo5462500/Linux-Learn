# Linux常用命令及使用技巧

## 3.1 Linux控制台的使用

### 3.1.1 什么是Shell
shell 本身是一个以C语言编写的程序，是用户和操作系统内核之间通信的桥梁。shell既是一种命令解释程序，又是一种功能 强大的解释型程序设计语言。作为命令解释程序，shell解释用户输入的命令，然后提交到内核处理，最后把结果返回给用户。        
为了加快命令的运行，同时更有效地定制shell 程序，shell 中定义了一些内置命令， 一般把shell 自身解释执行的命令称为内置命令。 例如， 下面将要讲到的cd、pw d、exit 和echo等命令， 都是属于bash的内置命令。 当用户登录系统后，shell 以及内置命令就被系统载入到内存，并且一直运行， 直到用户退出 系统为止。 除了内置命令 之外，Linux系统上还有很多可执行文件。 可执行文件类似于Windows下的 xe.e 文件，这些可执行文件也可以作为shell 命令来执行。其实Linux上很多命令 都不是shell的内置命令。 例如，ls就是一个可执行文件，存放在 /bin/ls中 。这些命令与shell 内置命令不同， 只有当它们被调用时， 才由系统装入内存 执行。        
最后，shell还是强大的解释型程序设计语言， 它定义了各种选项和变量，几乎支持高级程序语言的所有程序结构，如变量、函数、表达式和循环等。利用shell可以编写shell脚本程序，类似于Windows/DOS下的批处理文件，但是shell功能更加完善，更加强大。        
### 3.1.2 shell命令的语法分析
shell 语法分析是指shell对命令的扫描处理过程，也就是，把命令或者用户输入的内容分解成要处理的各个部分的操作。在Linux系统下，shell语法分析包含很多内容，如重定向、文件名扩展和管道等。        
1. shell的命令格式                
用户登录系统后，shell命令行启动。shell遵循一定的语法格式将用户输入的命令进行分析解释井传递给系统内核。shell命令的一般格式为：        
<code>commantd [options] {arguments}</code>        
其中，        
- command:表示命令的名称
- options:表示命令的选项
- arguments:表示命令的参数

在命令行中，选项是包含一个或多个字母的代码，主要用于改变命令的执行方式。 一般在选项前面有一个 “ － ” 符号，用于区别参数。
2. shell 的通配符
配符主要是为了方便用户对文件或者目录的描述，例如， 当用户仅仅需要以 “ 血”结尾的文件时， 使用通配符就能很方便地实现。 各个版本的shell都有通配符， 这些通配符是一些特殊字符， 用户可以在命令行的参数中使用这些字符， 进行文件名或者路径名的匹配。shell将把与命令行中指定的匹配规则符合的所有文件名或者路径名作为命令的参数， 然后执行这个命令。
bash中常用的通配符有“＊”、“？”、“［］”
(1) ”*” 匹配任意一个或多个字符
(2) "?" 匹配任意单一字符
(3) ”[]" 匹配任何包含在万括号内的单字符
(4) 通配符的组合使用        
<code>#ls [0~9]?.conf</code>        
这条命令列出当前目录下以数字开头，随后一个是任意字符，接着以 “ .conf” 结尾的所有文件。                
3. shell 的重定向        
Linux下系统打开3个文件，即标准输入、标准输出和标准错误输出。用户的shell将键盘设为默认的标准输入，默认的标准输出和标准错误输出为屏幕。也就是用户从键盘输入命令，然后将结果和错误消息输出到屏幕。
所谓的重定向，就是不使用系统默认的标准输入/输出,而是重新指定，因此重定向分为输入重定向、输出重定向和错误输出重定向要实现重定向就需要了解重定向操作符，shell 就是根据重定向操作符来决定重定向操作的。
(1) 输入重定向        
输入重定向用于改变命令的输入源，利用输入重定向，就可以将一个文件的内容作为命令的输入，而不从键盘输入。
用于输入重定向的操作符有 “<code><</code>” 和 “ <code><<</code>         ”。        
![Ispci](/picture/wc.png)        
这里用WC命令统计输入给它的文件／etc/inittab的行数、 单词数和字符数。                
连有一种输入重定向操作符 “＜＜飞这种重定向告诉shel l， 当前命令的标准输入为来自 命令行中一对分隔号之间的内容。        
![Ispci](/picture/wcaa.png)        
上面的 命令将一对分隔号aa之间的内容作为WC命令的输入。 分隔号可以是任意字符。 shell将在第一个分隔号后开始读取内容， 直到出现另一个分隔号读取结束， 然后将内容送给WC命令处理。        
(2）输出重定向        
输出重定向不是将命令的输出结果在屏幕输出， 而是输出到一个指定文件中。
在Linux下输出重定向用得很多。 例如， 某个命令的输出很长， 一个屏幕无法显示完毕，这时可以将命令的输出指定到一个文件， 然后用 more命令查看这个文件， 从而得到命令输出的完整信息。        
用于输出重定向的操作符有 “ ＞ ” 和 “ ＞＞ ”。        
<code>#ps -ef >ps.txt</code>        
这条命令将ps -ef输出的系统运行进程信息全部输入到了ps.txt文件， 而不输出到屏幕， 可以用more命令查看ps.txt文件中系统运行的进程信息。        
![Ispci](/picture/ps.png)        
<code>#more file1 file2 file3 >file</code>                
其中，more命令用于查看文件的内容，上面的命令是将自file2、file2和自file3的内容全部输出到file文件中，类似于文件内容的合并。        
如果在 “>” 后面指定的文件不存在，shell就会自动重建一个;如果文件存在，那么这个文件原有的内容将被覆盖；如果不想覆盖存在的文件，可以使用 “>>” 操作符。        
例如        
![Ispci](/picture/install.png)        
这条命令将／etc 目录及其子目录下的所有文件信息追加到／root/install.log 文件的后面。 /root/install.log文件原来的内容仍然存在。        
(3) 错误重定向                
错误重定向和标准输出重定向 一样，可以使用操作符 “ 2＞” 和 “ 2＞＞” 实现对错误输出,例如        
![Ispci](/picture/error.png)        
其中，即是打包命令，可以在屏幕上看到tar的解压过程。如果“text.tar.gz ” 是个损坏的压缩包，就会把错误消息输出到eηor且t文件。        
4. shell的管道        
管道可以把很多命令连接起来，可以把第l个命令的输入当作第2个命令的输出，第2命令的输出当作第3个命令的输入，依此类推。因此，管道的作用就是把一个命令的输出当作下一个命令的输入，而不经过任何中间文件。        
![Ispci](/picture/gaun.png)        
这条命令表示将／etc吕录以及子目录下的所有文件分屏显示。
5. shell中的引用        
(1)转义字符 “\”        
![Ispci](/picture/mvabc.png)        
上面是将 abc？＊重命名为 abc        
(2）单引号“‘”                
如果将字符串放到一对单引号之间，那么字符串中所有字符的特殊含义将被忽略，
(3) 双引号““””
双引号的引用与单引号基本相同， 包含在双引号内的大部分特殊字符可以当作普通字符处理， 但是仍有一些特殊字符即使用双引号括起来，也仍然保留自己的特殊含义， 比如 “$”,"\","'"        
6. shell的自动补全命令行        
当用户输入某个命令的一部分后， 按Tab键，shell就会根据系统环境变量信息提示出与 用户输入命令相似的所有命令和文件，         
## 3.2 系统管理与维护        
### 3.2.1 ls命令        
ls命令显示指定工作目录下的内容，列出工作目录所含的文件及子目录。此命令与Windows下的dir类似。 另外，Linux也提供了dir命令，用户也可以用dir命令代替ls命令。                
举例        
![Ispci](/picture/lsl.png)        
以上命令列出/root 目录下文件及其子目录        
![Ispci](/picture/lslf.png)            
以上命令显示/root下的所有文件及其子目录的详细信息，并显示文件类型标记        
### 3.2.2 ls命令
显示当前的工作目录， 执行pwd指令可立刻得知目前所在的工作目录的绝对路径名称，        
![Ispci](/picture/pwd.png)        
### 3.2.3 cd 命令
改变当前工作目录， 其用法与Windows下的cd类似。 具体的语法格式如下。        
![Ispci](/picture/cd.png)        
以上命令进入到usr目录下
### 3.2.4 date命令
显示或者修改系统时间与日期。 只有超级用户才能用 date 命令设置时间， 一般用户只能 用 date 命令显示时间。        
![Ispci](/picture/date1.png)        
以上命令是用指定的格式显示时间和日期。        
![Ispci](/picture/date28.png)                
以上命令为修改系统时间。        
![Ispci](/picture/date3.png)        
显示两天前的时间。        
### 3.2.5 passwd命令
用于设置用户密码        
![Ispci](/picture/passwd.png)        
然后根据提示连续两次输入密码即可。        
### 3.2.6  SU 命令
SU 命令主要用于改变用户身份
普通用户要成为超级用户， 可执行如下命令。        
<code>su -</code>        
根据系统提示输入超级用户密码， 即可转变为超级用户。        
### 3.2.7  clear命令        
clear命令用来清除屏幕信息        
<code>clear</code>        
### 3.2.8  man命令        
man命令用来显示指定命令的帮助信息        
![Ispci](/picture/man.png)        
### 3.2.9  who命令        
who命令显示目前登录到系统的用户        
![Ispci](/picture/who1.png)        
查询系统处于什么运行级别        
![Ispci](/picture/who2.png)        
显示系统最近启动日期，以及当前每个用户的登录详情、终端状态        
### 3.2.10  w命令        
用于显示登录到系统的用户信息        
![Ispci](/picture/w1.png)        
•上面第1行输出显示了当前的系统时间、系统从启动到现在己经运行的时间、登录到系统中的用户数和系统平均负载。平均负载是指在l分钟、5分钟、15分钟内系统负载状况。        
•USER： 表示登录系统的用户。        
•τTY： 表示用户使用的TTY名称。        
•FROM： 表示用户从哪里登录进来， 一般显示远程登录主机的E地址或者主机名。
•LOGIN＠： 用户登录的日期和时间。                
•IDLE： 表示某个程序上次从终端开始执行到现在所持续的时间。        
•JCPU： 表示该终端上的所有进程及子进程使用系统的总时间。        
•PCPU： 当前活动进程使用的系统时间。        
•WHAT： 当前用户执行的进程名称和选1页。        
### 3.2.11 uname命令
用来显示操作系统相关信息        
![Ispci](/picture/uname.png)        
-a:显示当前操作系统的全部信息        
-m:显示的是系统的CPU类型，是32位还是64位系统        
-n:显示的是操作系统的主机名        
-s:显示的是操作系统的类型        
-r:显示的操作系统的内核版本        
图中显示的是一个64位的Linux系统，内核版本为3.10.0-693.el7.x86_6，主机名称为VM_65_115_centos        
### 3.2.12 uptime命令        
uptime命令用来输出系统任务队列信息        
![Ispci](/picture/uptime.png)        
上面的输出表示现在系统时间是 00:30:35，系统已经运行38天零20小时22分钟，目前有1个用户在钱， 系统在l分钟、 5分钟、 15分钟前到现在的平均负载为0.0、 0.29、 1.46        
### 3.2.13 last 命令
列出目前与过去登入系统的用户相关信息。当执行last指令时，它会默认读取位于/var/log目录下名称为wtmp的文件， 并把该给文件记录的登入系统的用户名单全部显示出来。        
![Ispci](/picture/last.png)        
### 3.2.14 dmesg命令        
显示开机信息。 内核会将开机信息存储在系统缓冲区（ ring buffer）中， 如果开机来不及 查看相关信息， 可以在开机后利用dmesg命令查看， 也可以在／var/log／目录中查看dmesg文件。         
![Ispci](/picture/dmesg.png)        
### 3.2.15 free命令
free 命令用来显示系统内存状态， 具体包括系统物理内存、 虚拟内存、 共享内存和系统缓存。         
![Ispci](/picture/free.png)        
系统总的物理内存为1839MB,已经使用了650MB，可用内存有160mb。
### 3.2.16 ps命令
ps命令显示系统进程在瞬间的运行动态        
![Ispci](/picture/ps1.png)        
以上命令查看系统目前使用这的进程。        
![Ispci](/picture/ps2.png)        
以上命令查看系统所有的进程。        
### 3.2.17 top命令
top命令提供了对系统处理器状态的实时监控，它能够实时显示系统中各个进程的资源占用状况。该命令可以按照对CPU的使用、内存使用和执行时间对系统任务进程进行排序显示， 同时top命令还可以通过交互式命令进行设定显示。        
![Ispci](/picture/top.png)        
，top的输出可以分为统计信息区和进程信息区两个部分，即前5行为统计信息区，下面几行为进程信息区，下面分别介绍两种信息区。        
(1)统计信息区        
第l行为任务队列信息，含义如下。
•  00:55:20：表示当前系统时间。        
•  up 38 days, 20: 47：表示系统己经启动38天零20小时47分钟了。        
•  2 users：当前登录系统的用户数。        
•  load average: 0.00, 0.01, 0.30：表示系统平均负载，3个数值分别表示l分钟、5分钟、 15分钟前到现在的系统平均负载值。
第2行和第3行分别为进程和CPU信息，具体含义如下。        
•  Tasks: 72 total：进程的总数。        
•  2 running：正在运行的进程数。            
•  70 sleeping：处于休眠状态的进程数。        
•  0 stopped：停止的进程数。        
•  0 zombie：僵死的进程数。        
•  Cpu(s): 0.3% us：表示用户进程占用CPU的百分比。        
•  0.0% sy：系统进程占用CPU的百分比。
•  0.0% ni：用户进程空间内改变过优先级的进程占用CPU的百分比。        
•  99.3% id：空闲CPU占用的百分比。        
•  0.3% wa：等待输入、输出的进程占用CPU的百分比。        
最后两行输出的是内存信息，具体含义如下。
•  Mem: 1883616 total：系统的物理内存大小。        
•  669112 used：己经使用的物理内存大小。        
•  160488 free：目前空余内存大小。        
•  1054096 buffers：用作内核缓冲区的内存大小。        
•  Swap: 0total：交换分区内存大小。        
•  Ok used：己经使用的交换分区大小。        
•  1017968 free：空闲的交换分区大小。        
•  2320396k cached：缓存大小。        
(2)进程信息区
进程信息区显示了每个进程的运行状态，我们先来看每一下每列输出的含义。        
•  PID：进程的id。        
•  USER：进程所有者的用户名。        
•  PR：进程优先级。                
•  NI: nice值。负值表示高优先级，正值表示低优先级。        
•  VIRI: 进程使用的虚拟内存总量，单位KB，VIPT-SWAP+RES。        
•  RES:进程使用的，未被换成的物理内存大小，单位KB。RES=CODE+DATA,其中，CODE为执行代码占用的物理内存大小，DATA为数据占用的内存大小。        
•  %SHR：共享内存大小，单位KB。        
•  %S：进程状态，D代表不可终端的睡眠状态，R代表运行状态，S表示睡眠状态，T代表跟踪/停止，Z表示姜丝进程。        
•  %CPU：上次更新到现在的CPU时间占用百分比。        
•  %MEM：进程占用的物理内存百分比。        
•  TIME＋：进程总计使用的CPU时间，单位为1/100秒。        
•  COMMAND：正在运行进程的命令名或者命令路径。        
## 3.3 文件管理与编辑
### 3.3.1 mkdir命令
mkdir命令用于创建一个目录。mkdir是makedirectory的缩写。
![Ispci](/picture/mkdir.png)            
在/home下创建user！目录， 同时在user！下创建user2目录， 也就是说， 连续创建两个目录
### 3.3.2 more 命令
如果一个文本文件比较氏， 一屏无法显示完毕， 就需要使用more命令。 more命令读取 文本文件时， 每次显示一屏， 并且在每屏后暂停， 同时在屏幕底部显示单词 “More飞如果 此时按Enter键， more命令就会接着再显示文本的一行， 依此类推：如果按空格键， more命 令就继续显示文本文件的另一屏信息。    
![Ispci](/picture/mkdir.png)            
### 3.3.3 cat命令
cat命令用来将文件的内容输出到标准输出，类似于DOS下的type命令，同时cat还可以用于连接合并文件。     
![Ispci](/picture/cat.png)         `    
以下命令将文件filel.txt和file1.txt的内容合并后输出到文件file3.txt
### 3.3.4 diff命令
diff命令用来比较文件的差异。di町以逐行的方式比较文本文件的异同，如果指定比较的是目录，则diff会比较目录中相同文件名的文件，但不会比较其中的子目录。        
![Ispci](/picture/cat1.png)              
"1C1":第一个1代表file1.txt的行号，C代表修改（a:附加;b:删除;c:修改;）,第二个1代表file2.txt的行号        
### 3.3.5 grep命令
grep命令是Linux下的文本过滤工具， grep根据指定的字符串， 对文件的每一行进行搜索 如果找到了这个字符串， 就输出该行的内容。        
![Ispci](/picture/grep.png)   
### 3.3.6 rm命令
m命令用来删除某个目录及其下的所有文件及子目录。对于链接文件，只是断开了链接，原文件保持不变。 
![Ispci](/picture/rm.png)         
### 3.3.7 touch命令
touch命令用来改变指定文件的访问时间和修改时间，若指定文件不存在则创建此文件。如果没有指定时间，则使用当前时间。            
![Ispci](/picture/touch.png)  
<code>touch text.txt #创建一个文件名为text.txt</code>        
<code>ls lu 显示文件的访问时间</code>        
<code></code>        
<code></code>        